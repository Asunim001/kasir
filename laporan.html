<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>Laporan Omzet</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #fff8ee;
      }
      h2 {
        color: #c0392b;
      }
      select, input {
        margin: 10px 0;
        padding: 5px;
        font-size: 14px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }
      th, td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: left;
      }
      th {
        background: #f1c40f;
      }
    </style>
  </head>
  <body>
    <h2>Laporan Omzet Harian</h2>
    <input type="date" id="tanggalHarian" onchange="tampilkanHarian()">

    <div id="harianResult"></div>

    <h2>Laporan Omzet Bulanan</h2>
    <input type="month" id="bulan" onchange="tampilkanBulanan()">

    <div id="bulananResult"></div>

    <script>
      let data = {};

      function formatRupiah(angka) {
        return new Intl.NumberFormat('id-ID', {
          style: 'currency',
          currency: 'IDR'
        }).format(angka);
      }

      function tampilkanHarian() {
        const tgl = document.getElementById("tanggalHarian").value;
        const hasil = document.getElementById("harianResult");
        if (!data.harian[tgl]) {
          hasil.innerHTML = "Tidak ada data.";
          return;
        }

        let html = "<table><tr><th>Barang</th><th>Total</th></tr>";
        for (let barang in data.harian[tgl]) {
          html += `<tr><td>${barang}</td><td>${formatRupiah(data.harian[tgl][barang])}</td></tr>`;
        }
        html += "</table>";
        hasil.innerHTML = html;
      }

      function tampilkanBulanan() {
        const bln = document.getElementById("bulan").value;
        const hasil = document.getElementById("bulananResult");
        if (!data.bulanan[bln]) {
          hasil.innerHTML = "Tidak ada data.";
          return;
        }

        let html = "<table><tr><th>Barang</th><th>Total</th></tr>";
        for (let barang in data.bulanan[bln]) {
          html += `<tr><td>${barang}</td><td>${formatRupiah(data.bulanan[bln][barang])}</td></tr>`;
        }
        html += "</table>";
        hasil.innerHTML = html;
      }

      google.script.run.withSuccessHandler(function(response) {
        data = response;
      }).getLaporanData();
    </script>
  </body>
</html>
